# Stigmergy CLI 端到端测试计划

## 1. 测试目标

全面验证Stigmergy CLI系统的所有功能，包括：
- 所有8个AI CLI工具的独立调用能力
- 工具间的协作功能
- 错误处理和边界情况
- 跨平台兼容性

## 2. 测试环境

### 2.1 操作系统
- Windows 10/11
- macOS (最新版本)
- Ubuntu Linux (20.04 LTS 或更新)

### 2.2 依赖环境
- Node.js 16.x 或更高版本
- Python 3.8 或更高版本
- npm 8.x 或更高版本

### 2.3 AI CLI工具
1. Claude CLI
2. Gemini CLI  
3. Qwen CLI
4. iFlow CLI
5. Qoder CLI
6. CodeBuddy CLI
7. GitHub Copilot CLI
8. OpenAI Codex CLI

## 3. 测试用例设计

### 3.1 基础功能测试

#### 3.1.1 CLI工具独立调用测试
为每个CLI工具设计以下测试用例：

1. **简单代码生成**
   - 输入：生成一个简单的函数（如加法函数）
   - 预期：返回有效的代码实现

2. **复杂代码生成**  
   - 输入：生成一个复杂的算法实现（如排序算法）
   - 预期：返回完整且正确的代码实现

3. **文本分析**
   - 输入：分析一段代码的安全性或性能
   - 预期：返回有意义的分析结果

4. **文档生成**
   - 输入：为指定函数生成文档
   - 预期：返回格式正确的文档

#### 3.1.2 智能路由测试
1. **关键词识别**
   - 输入：包含工具名称的自然语言指令
   - 预期：正确路由到指定工具

2. **默认路由**
   - 输入：不包含明确工具名称的指令
   - 预期：路由到默认工具（Claude）

3. **复杂路由**
   - 输入：包含多个工具关键词的复杂指令
   - 预期：选择最合适的目标工具

### 3.2 协作功能测试

#### 3.2.1 工具链调用
1. **连续任务执行**
   - 输入：需要多个工具协作完成的任务
   - 预期：各工具按顺序正确执行

2. **结果传递**
   - 输入：前一个工具的结果作为下一个工具的输入
   - 预期：正确传递和处理中间结果

#### 3.2.2 上下文保持
1. **会话维持**
   - 输入：多个相关的连续请求
   - 预期：保持上下文一致性

### 3.3 错误处理测试

#### 3.3.1 工具不可用
1. **工具未安装**
   - 操作：尝试调用未安装的工具
   - 预期：给出清晰的错误提示和安装建议

2. **工具执行失败**
   - 操作：构造会导致工具执行失败的输入
   - 预期：捕获错误并给出适当反馈

#### 3.3.2 参数错误
1. **无效参数**
   - 操作：传递无效或缺失的参数
   - 预期：给出参数验证错误

2. **边界情况**
   - 操作：测试极端输入（超长字符串、特殊字符等）
   - 预期：系统稳定运行，不会崩溃

### 3.4 性能测试

#### 3.4.1 响应时间
1. **单工具调用延迟**
   - 测量各工具的平均响应时间

2. **协作调用延迟**
   - 测量多工具协作的总响应时间

#### 3.4.2 资源消耗
1. **内存使用**
   - 监控执行过程中的内存占用

2. **CPU使用率**
   - 监控执行过程中的CPU占用

## 4. 测试执行步骤

### 4.1 环境准备
1. 清理现有安装
2. 重新安装Stigmergy CLI
3. 安装所有AI CLI工具
4. 部署钩子和配置

### 4.2 基础功能测试
1. 逐一测试每个CLI工具的4个基本功能
2. 记录每个测试的结果和响应时间
3. 验证响应内容的正确性

### 4.3 协作功能测试
1. 执行预设的工具链调用场景
2. 验证中间结果的传递准确性
3. 检查最终结果的完整性

### 4.4 错误处理测试
1. 模拟各种错误情况
2. 验证错误提示的准确性和友好性
3. 确认系统在错误后的恢复能力

### 4.5 性能测试
1. 多次执行相同测试用例
2. 记录响应时间和资源消耗
3. 分析性能数据

## 5. 测试通过标准

### 5.1 功能正确性 (权重: 40%)
- 所有测试用例的预期结果正确率达到95%以上

### 5.2 系统稳定性 (权重: 30%)  
- 在错误处理测试中系统不崩溃
- 能够正确恢复和继续执行

### 5.3 性能指标 (权重: 20%)
- 单工具调用响应时间不超过30秒
- 协作调用总响应时间不超过2分钟

### 5.4 用户体验 (权重: 10%)
- 错误提示清晰易懂
- 执行过程有适当的进度反馈

## 6. 测试报告输出

### 6.1 测试摘要
- 总体通过率
- 各类测试的详细结果
- 发现的主要问题

### 6.2 详细测试结果
- 每个测试用例的执行记录
- 响应时间统计
- 资源消耗数据

### 6.3 问题列表
- 发现的所有问题及其严重程度
- 问题复现步骤
- 建议的修复方案

### 6.4 改进建议
- 基于测试结果的优化建议
- 用户体验改进点
- 性能优化方向