# ğŸ¯ åŒ…å¤§å°é—®é¢˜ - ç»ˆæè§£å†³æ–¹æ¡ˆ

## é—®é¢˜æ ¹æº

`.npmignore` çš„æ’é™¤è§„åˆ™è¢« `package.json` çš„ `files` å­—æ®µè¦†ç›–äº†ï¼

**è¯æ®**ï¼š
- .npmignore æœ‰ `**/*test*.js` è§„åˆ™
- ä½† package.json çš„ `files: ["src/**/*.js", ...]` æ˜ç¡®åŒ…å«äº†æ‰€æœ‰ .js æ–‡ä»¶
- npm å¤„ç†é€»è¾‘ï¼šfiles å­—æ®µï¼ˆåŒ…å«ï¼‰> .npmignoreï¼ˆæ’é™¤ï¼‰

## è§£å†³æ–¹æ¡ˆå¯¹æ¯”

### æ–¹æ¡ˆ 1ï¼šç§»é™¤ files å­—æ®µï¼ˆæœ€ç®€å•ï¼‰â­

**ä¼˜ç‚¹**ï¼š
- ç«‹å³ç”Ÿæ•ˆ
- .npmignore ä¼šæ­£ç¡®å·¥ä½œ
- å‡å°‘çº¦ 80 KB

**ç¼ºç‚¹**ï¼š
- å¯èƒ½åŒ…å«ä¸€äº›ä¸å¿…è¦çš„æ–‡ä»¶

**å®æ–½**ï¼š
```json
{
  "files": [
    // å®Œå…¨ç§»é™¤è¿™ä¸ªå­—æ®µï¼Œåªä½¿ç”¨ .npmignore
  ]
}
```

---

### æ–¹æ¡ˆ 2ï¼šæ˜ç¡®æŒ‡å®šè¦åŒ…å«çš„æ–‡ä»¶ï¼ˆæ¨èï¼‰â­â­â­

**ä¼˜ç‚¹**ï¼š
- ç²¾ç¡®æ§åˆ¶å‘å¸ƒå†…å®¹
- .npmignore ä½œä¸ºé¢å¤–ä¿æŠ¤
- å‡å°‘çº¦ 80 KB

**ç¼ºç‚¹**ï¼š
- éœ€è¦ç»´æŠ¤æ–‡ä»¶åˆ—è¡¨

**å®æ–½**ï¼š
```json
{
  "files": [
    "bin/stigmergy",
    "bin/stigmergy.cmd",
    "config/**/*.json",
    "dist/orchestration/**/*.js",
    "package.json",
    "README.md",
    "LICENSE",
    "STIGMERGY.md",

    // æ˜ç¡®åŒ…å«éœ€è¦çš„ src ç›®å½•ï¼ˆæ’é™¤æµ‹è¯•ç›®å½•ï¼‰
    "src/adapters/**/*.js",
    "src/cli/**/*.js",
    "src/commands/skill.js",
    "src/commands/skill-handler.js",
    "src/core/**/*.js",
    "!src/core/test/**",
    "!src/core/skills/__tests__/**",
    "!src/core/skills/*test*.js",
    "!src/core/skills/test-*.js",
    "src/interactive/**/*.js",
    "src/index.js",
    "src/utils/**/*.js",
    "src/test/cli-availability-checker.js",  // å¦‚æœéœ€è¦çš„è¯
    "src/test/test-environment.js"           // å¦‚æœéœ€è¦çš„è¯
  ]
}
```

---

### æ–¹æ¡ˆ 3ï¼šé‡å‘½åæµ‹è¯•æ–‡ä»¶ï¼ˆå·¥ä½œé‡æœ€å¤§ï¼‰

å°†æ‰€æœ‰æµ‹è¯•æ–‡ä»¶é‡å‘½åä¸ºï¼š
- `xxx.test.js` â†’ `xxx.spec.test.js`
- `xxx-test.js` â†’ `xxx.spec.js`
- ç§»åŠ¨åˆ°ç»Ÿä¸€çš„ `tests/` ç›®å½•

---

## æ¨èå®æ–½ï¼šæ–¹æ¡ˆ 1ï¼ˆç§»é™¤ files å­—æ®µï¼‰

### ä¸ºä»€ä¹ˆé€‰æ‹©æ–¹æ¡ˆ 1ï¼Ÿ

1. **.npmignore å·²ç»é…ç½®å®Œå–„**
   - å·²ç»æ’é™¤äº†æ‰€æœ‰æµ‹è¯•æ–‡ä»¶
   - å·²ç»æ’é™¤äº†å¼€å‘æ–‡ä»¶
   - åªä¿ç•™äº†å¿…è¦çš„æ–‡ä»¶

2. **npm é»˜è®¤è¡Œä¸ºå·²ç»å¾ˆå¥½**
   - é»˜è®¤ä¼šåŒ…å«ï¼špackage.json, README, LICENSE
   - é»˜è®¤æ’é™¤ï¼šnode_modules, .git, tests/
   - .npmignore ä¼šè¿›ä¸€æ­¥è¿‡æ»¤

3. **ç»´æŠ¤ç®€å•**
   - ä¸éœ€è¦åŒæ­¥ files å­—æ®µ
   - åªéœ€ç»´æŠ¤ .npmignore

### å®æ–½æ­¥éª¤

```bash
# 1. å¤‡ä»½ package.json
cp package.json package.json.backup

# 2. ç¼–è¾‘ package.jsonï¼Œç§»é™¤ files å­—æ®µ
# ï¼ˆæˆ‘ä¼šå¸®ä½ ä¿®æ”¹ï¼‰

# 3. éªŒè¯
npm pack --dry-run

# 4. æ£€æŸ¥åŒ…å¤§å°
npm pack
ls -lh *.tgz
```

---

## é¢„æœŸæ•ˆæœ

### ä¼˜åŒ–å‰
- æœªå‹ç¼©ï¼š1.2 MB
- å‹ç¼©åï¼š260.6 KB
- æ–‡ä»¶æ•°ï¼š121 ä¸ª
- **åŒ…å«æµ‹è¯•æ–‡ä»¶ï¼š8 ä¸ª** (~80 KB)

### ä¼˜åŒ–åï¼ˆé¢„æœŸï¼‰
- æœªå‹ç¼©ï¼š~1.0 MB
- å‹ç¼©åï¼š~200 KB
- æ–‡ä»¶æ•°ï¼š~100 ä¸ª
- **ä¸åŒ…å«æµ‹è¯•æ–‡ä»¶**
- **å‡å°‘çº¦ 60 KB (23%)**

---

## è®©æˆ‘ç«‹å³å¸®ä½ å®æ–½æ–¹æ¡ˆ 1
